# Задание 5. Система отслеживания посылок

## Описание:
Разработать архитектуру системы, позволяющую пользователям отслеживать статус их посылок в режиме реального времени.

## Решение по System Design должно включать:

- Количество запросов в секунду (RPS)
- Расчет объема сохраняемых данных
- Расчет объема читаемых данных
- Схему компонентов
- Примерное перечисление ендпоинтов API с указанием базовых полей запроса и ответа

### Use Cases:
- Регистрация посылки
- Обновление статуса посылки
- Получение информации о статусе

### Нагрузка:
- DAU: 2 млн пользователей
- Среднее количество обновлений статуса в день: 10 млн
- Время хранения данных: 6 месяцев

### Out of Scope:
- Интеграция с физическим оборудованием

# Решение:

## Количество запросов в секунду (RPS)

1. **Обновление статуса:** 10 000 000 / (24 * 3600) ≈ 116 RPS 
2. **Получение информации о статусе:** Предположим, что каждый активный пользователь запрашивает статус посылки в среднем 2 раза в день: 2 000 000 * 2 = 4 000 000 запросов в день
    - **RPS для получения статуса:** 4 000 000 / (24 * 3600) ≈ 46 RPS 
3. **Регистрация посылок:** Предположим 10% от обновлений статуса в день: 10 000 000 * 0.1 = 1 000 000 регистраций в день
    - **RPS для регистрации:** 1 000 000 / (24 * 3600) ≈ 12 RPS
### ИТОГО:
**Общий средний RPS:** 116 + 46 + 12 ≈ **174 RPS** 

## Расчет объема сохраняемых данных

1. **Размер записи о посылке:** Предположим, что одна запись (включая ID посылки, ID пользователя, историю статусов, текущий статус) занимает около 1 KB
2. **Регистрация посылок:** Предположим 10% от обновлений статуса в день: 10 000 000 * 0.1 = 1 000 000 регистраций в день
3. **Количество записей:**
    - **Ежедневные обновления статуса:** 10 000 000 * 1 KB = 10 GB в день
    - **Ежедневные регистрации:** 1 000 000 * 1 KB = 1 GB в день
    - **Итого:** 10 + 1 = 11 GB в день
### ИТОГО:
**Общий объем данных за 6 месяцев:** 11 GB * 180 дней ≈ 1980 GB 

## Расчет объема читаемых данных

1. **Получение информации о статусе:** Предположим, что каждый активный пользователь запрашивает статус посылки в среднем 2 раза в день: 2 000 000 * 2 = 4 000 000 запросов в день
2. **Размер чтения:** Предположим, что запрос на чтение статуса посылки возвращает около 1 KB данных 
### ИТОГО:
**Объем читаемых данных:** 4 000 000 запросов в день * 1 KB = 4 GB в день

## Схема компонентов



## Примерное перечисление ендпоинтов API с указанием базовых полей запроса и ответа

### 1. Регистрация посылки:
1. Endpoint: POST /parcels
2. Request Body (JSON):

```json
{
    "userId": "user123",
    "sender": "Имя отправителя",
    "recipient": "Имя получателя" ,
    "destination": "Адрес назначения"
}
```

3. Response (JSON):

```json
{
  "parcelId": "parcel456",
   "status": "registered"
}
```

### 2. Обновление статуса посылки:
1. Endpoint: POST /parcels/{parcelId}/status
2. Request Body (JSON):

```json 
{
    "status": "inTransit",
    "location": "Склад 123"
}
```

3. Response (JSON):

```json
{
     "parcelId": "parcel456",
     "status": "inTransit"
 }
 ```

### 3. Получение информации о статусе посылки:
1. Endpoint: GET /parcels/{parcelId}
2. Response (JSON):

```json
{
    "parcelId": "parcel456",
    "status": "inTransit",
    "history": [
        {
          "status": "registered",
          "location": null,
          "timestamp": "2024-10-27T10:00:00Z"
        },
        {
            "status": "inTransit",
            "location": "Склад 123",
            "timestamp": "2024-10-27T12:00:00Z"
        }
    ],
    "sender": "Имя отправителя",
    "recipient": "Имя получателя"
}
```













